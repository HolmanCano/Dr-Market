<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Producto | Dr-Market</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/landing-theme.css">
  </head>
  <body>
    <header>
      <div class="container nav">
        <a class="brand" href="landing.html#inicio">
          <span class="brand-logo" aria-hidden="true"></span>
          <span>Dr'Market</span>
        </a>
        <nav class="nav-actions" aria-label="Principal">
          <a class="btn" href="landing.html#inicio">Inicio</a>
          <a class="btn" href="index.html">Tienda</a>
          <a class="btn" href="nosotros.html">Nosotros</a>
          <a class="btn btn-cart" href="carrito.html">
            <span class="cart-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" focusable="false">
                <path d="M7.75 20a1.75 1.75 0 1 1 0-3.5 1.75 1.75 0 0 1 0 3.5Zm8.5 0a1.75 1.75 0 1 1 0-3.5 1.75 1.75 0 0 1 0 3.5ZM4.25 4.5h-1.5V3h2.1a1.25 1.25 0 0 1 1.2.9l.36 1.3H21.5a.75.75 0 0 1 .72.96l-2 7.25a1.75 1.75 0 0 1-1.68 1.29H9.24l-.37 1.36h11.63v1.5H7.59a1.25 1.25 0 0 1-1.2-1.6l1.02-3.76-2.22-8.2Z"/>
              </svg>
            </span>
            <span class="cart-text">Carrito</span>
            <span class="cart-count" data-cart-count aria-live="polite">0</span>
          </a>
        </nav>
      </div>
    </header>

    <main>
      <section class="surface-block">
        <div class="product-detail">
          <figure class="product-preview toneable" data-product-preview data-tone-active="false">
            <img id="product-image" src="img/modelo-3.svg" alt="Producto seleccionado">
          </figure>
          <div>
            <h1 id="product-name" class="section-title">Producto</h1>
            <p class="section-sub">Camiseta unisex 100&nbsp;% algod&oacute;n org&aacute;nico con estampado premium.</p>
            <div class="price" id="product-price">25&nbsp;&euro;</div>
            <div class="badges">
              <span class="badge">Corte unisex</span>
              <span class="badge">Edici&oacute;n 2024</span>
              <span class="badge">Tintas libres de ftalatos</span>
            </div>
            <form class="form" action="#" method="post">
              <label for="color">Selecciona color</label>
              <select id="color" name="color" required>
                <option value="" selected disabled>Elige una opci&oacute;n</option>
                <option value="Blanco">Blanco</option>
                <option value="Negro">Negro</option>
                <option value="Azul marino">Azul marino</option>
                <option value="Rojo">Rojo</option>
                <option value="Verde">Verde</option>
              </select>
              <label for="talla">Selecciona talla</label>
              <select id="talla" name="talla" required>
                <option value="" selected disabled>Elige una opci&oacute;n</option>
                <option value="s">Small</option>
                <option value="m">Medium</option>
                <option value="l">Large</option>
                <option value="xl">XL</option>
              </select>
              <label for="cantidad">Cantidad</label>
              <input id="cantidad" name="cantidad" type="number" min="1" value="1" required>
              <button type="submit">Agregar al carrito</button>
            </form>
          </div>
        </div>
      </section>

      <section class="surface-block compact">
        <h2 class="section-title">Detalles t&eacute;cnicos</h2>
        <div class="features">
          <div class="feature">
            <div class="icon">TELA</div>
            <div>
              <h4>Algod&oacute;n ultrafino</h4>
              <p>180 g/m&sup2; peinado, ideal para climas templados.</p>
            </div>
          </div>
          <div class="feature">
            <div class="icon">COLOR</div>
            <div>
              <h4>Azul profundo</h4>
              <p>Te&ntilde;ido reactivo que preserva la intensidad tras cada lavado.</p>
            </div>
          </div>
          <div class="feature">
            <div class="icon">CUIDO</div>
            <div>
              <h4>Mantenimiento sencillo</h4>
              <p>Lavar en fr&iacute;o, secar a la sombra y planchar del rev&eacute;s para conservar el estampado.</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-inner">
        <a class="footer-brand" href="landing.html#inicio">
          <span class="footer-logo" aria-hidden="true"></span>
          <span>Dr'Market</span>
        </a>
        <p>&copy; 2024 Dr'Market. Todos los derechos reservados.</p>
        <a href="mailto:hola@drmarket.com">hola@drmarket.com</a>
      </div>
    </footer>
        <script src="js/cart.js"></script>
    <script>
      (function () {
        const form = document.querySelector(".form");
        if (!form || !window.cartManager) return;

        const params = window.cartManager.parseUrlParams();
        const nameEl = document.getElementById("product-name");
        const priceEl = document.getElementById("product-price");
        const imageEl = document.getElementById("product-image");
        const preview = document.querySelector("[data-product-preview]");
        const colorSelect = document.getElementById("color");

        if (nameEl && params.name) {
          nameEl.textContent = params.name;
        }

        if (priceEl) {
          const basePrice = (() => {
            const raw = priceEl.textContent || "0";
            const match = raw.replace(/\s/g, "").match(/([0-9]+(?:[\.,][0-9]+)?)/);
            return match ? Number(match[1].replace(",", ".")) : 0;
          })();
          priceEl.dataset.price = String(basePrice);

          if (typeof params.price === "number" && !Number.isNaN(params.price)) {
            priceEl.dataset.price = String(params.price);
            priceEl.textContent = window.cartManager.formatPrice(params.price);
          } else {
            priceEl.textContent = window.cartManager.formatPrice(Number(priceEl.dataset.price || 0));
          }
        }

        const baseImage = params.image || imageEl?.getAttribute("src") || "";
        if (imageEl && baseImage) {
          imageEl.setAttribute("src", baseImage);
        }

        const applyColorTone = (colorName) => {
          if (!preview) return;
          const preset = window.cartManager.getColorPreset?.(colorName);
          if (!preset) {
            preview.dataset.toneActive = "false";
            delete preview.dataset.toneBlend;
            preview.style.removeProperty("--tone-color");
            preview.style.removeProperty("--tone-opacity");
            preview.style.removeProperty("--tone-filter");
            preview.style.removeProperty("--tone-bg");
            return;
          }

          preview.dataset.toneActive = "true";
          preview.dataset.toneBlend = preset.blend || "multiply";
          preview.style.setProperty("--tone-color", preset.color);
          preview.style.setProperty("--tone-opacity", String(preset.opacity));
          preview.style.setProperty("--tone-filter", preset.filter);
          preview.style.setProperty("--tone-bg", preset.background);
        };

        if (colorSelect) {
          colorSelect.addEventListener("change", (event) => {
            applyColorTone(event.target.value);
          });
        }

        applyColorTone(colorSelect?.value || "");

        form.addEventListener("submit", (event) => {
          event.preventDefault();
          const name = nameEl?.textContent?.trim() || "Producto";
          const price = Number(priceEl?.dataset.price || 0);
          const quantity = Math.max(1, Number(document.getElementById("cantidad")?.value || 1));
          const size = document.getElementById("talla")?.value || "";
          const color = document.getElementById("color")?.value || "";
          const image = imageEl?.getAttribute("src") || "";

          window.cartManager.addItem({ name, price, quantity, size, color, image });
          window.location.href = "carrito.html";
        });
      })();
    </script>
  </body>
</html>



